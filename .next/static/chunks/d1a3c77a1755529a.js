(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54173,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(3922);async function a(e){let t=(0,s.createClientBrowser)(),{data:r,error:a}=await t.from("user_profiles").select("plan_tier, signups_used_this_month, signup_limit").eq("id",e).single();if(console.log("[checkSignupLimitClient] Query result:",{profile:r,error:a,userId:e}),a)return console.error("Error fetching user profile:",a),{limitReached:!1,showUpgrade:!1,currentUsage:0,limit:100,planTier:"free",error:a.message};if(!r)return console.log("[checkSignupLimitClient] No profile found for userId:",e),{limitReached:!1,showUpgrade:!1,currentUsage:0,limit:100,planTier:"free"};let l=r.signups_used_this_month??0,i=r.signup_limit??100,n=r.plan_tier??"free",o=l>=i;return console.log("[checkSignupLimitClient] Check result:",{planTier:n,currentUsage:l,limit:i,limitReached:o}),{limitReached:o,showUpgrade:o,currentUsage:l,limit:i,planTier:n}}let l=[{value:"too_expensive",label:"Too expensive"},{value:"dont_need",label:"Don't need that many signups"},{value:"just_testing",label:"Just testing"},{value:"upgrade_later",label:"Will upgrade later"},{value:"missing_features",label:"Missing features"}];function i({onClose:e,onSubmit:a,onFeedbackSent:i}){let[n,o]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(""),g=async()=>{if(!n)return void h("Please select a reason");m(!0),h("");try{let e=(0,s.createClientBrowser)(),{data:{user:t}}=await e.auth.getUser(),{error:r}=await e.from("feedback").insert({user_id:t?.id,reason:n,feedback_text:d.trim()||null,type:"upgrade_declined"});if(r){console.error("Failed to save feedback:",r),h("Failed to save feedback"),m(!1);return}o(""),c(""),i&&i(),a()}catch(e){console.error("Error submitting survey:",e),h("Something went wrong")}finally{m(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Help us improve"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Why are you not upgrading today?"})]}),(0,t.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,t.jsxs)("label",{className:`flex items-center p-3 rounded-lg border cursor-pointer transition-colors ${n===e.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[(0,t.jsx)("input",{type:"radio",name:"reason",value:e.value,checked:n===e.value,onChange:e=>o(e.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"ml-3 text-sm text-gray-700",children:e.label})]},e.value))}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Any other feedback? (optional)"}),(0,t.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),placeholder:"Tell us more...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm text-[#2a2a2a]"})]}),x&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:x}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:e,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:g,disabled:u,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Submitting...":"Submit"})]})]})}function n({isOpen:e,onClose:s,currentSignups:a=0,signupLimit:l=100,onFeedbackSent:n}){let[o,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null);if(!e)return null;let h=async()=>{x(null),u(!0);try{let e=await fetch("/api/create-checkout",{method:"POST"}),t=await e.json().catch(()=>({}));if(!e.ok)throw Error(t?.error||"Failed to start checkout");if(!t?.url)throw Error("No checkout URL returned");window.location.href=t.url}catch(e){console.error("Checkout error:",e),x(e?.message||"Failed to start checkout"),u(!1)}};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),(0,t.jsx)("div",{className:"relative bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:o?(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(i,{onClose:()=>{d(!1)},onSubmit:()=>{d(!1),s()},onFeedbackSent:()=>{n&&n()}})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-8 text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-3",children:"ðŸŽ£"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"You've reached your limit"}),(0,t.jsxs)("p",{className:"text-blue-100",children:[a," / ",l," signups used"]})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Upgrade to Pro"}),(0,t.jsxs)("div",{className:"flex items-baseline justify-center gap-1",children:[(0,t.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:"â‚¬29"}),(0,t.jsx)("span",{className:"text-gray-600",children:"/month"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"for 1,000 signups per month"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Your plan upgrades automatically after payment."})]}),(0,t.jsx)("ul",{className:"space-y-2 mb-6",children:["1,000 signups per month","Advanced lead scoring","Export to CSV","Priority support"].map((e,r)=>(0,t.jsxs)("li",{className:"flex items-center text-sm text-gray-700",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-green-500 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e]},r))}),(0,t.jsxs)("div",{className:"space-y-3",children:[m&&(0,t.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:m}),(0,t.jsx)("button",{onClick:h,disabled:c,className:"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Starting checkoutâ€¦":"Upgrade Now"}),(0,t.jsx)("button",{onClick:()=>{d(!0)},disabled:c,className:"w-full py-3 px-4 text-gray-600 font-medium hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:"Maybe Later"})]})]})]})})]})})}function o({userId:e,onWaitlistCreated:l}){let[i,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[g,p]=(0,r.useState)(!1),[b,f]=(0,r.useState)(""),[v,y]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),N=async()=>{f("");try{let t=await a(e);w({currentUsage:t.currentUsage,limit:t.limit}),t.limitReached?c(!0):o(!0)}catch(e){console.error("Error checking limit:",e),f("Failed to check limit. Please try again.")}},C=async t=>{if(t.preventDefault(),!u.trim())return void f("Please enter a waitlist name");p(!0),f("");try{let t=(0,s.createClientBrowser)(),{data:r,error:a}=await t.from("waitlists").insert({owner_id:e,name:u.trim(),description:x.trim()||null}).select().single();if(a){console.error("Error creating waitlist:",a),f("Failed to create waitlist. Please try again.");return}m(""),h(""),o(!1),l&&l()}catch(e){console.error("Error creating waitlist:",e),f("Something went wrong. Please try again.")}finally{p(!1)}};return(0,r.useEffect)(()=>{if(v){let e=window.setTimeout(()=>y(null),5e3);return()=>window.clearTimeout(e)}},[v]),(0,t.jsxs)(t.Fragment,{children:[v&&(0,t.jsx)("div",{className:"fixed top-5 right-5 z-[9999]",children:(0,t.jsx)("div",{className:"max-w-sm rounded-lg border border-green-200 bg-green-50 px-4 py-3 shadow-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"mt-0.5 text-green-600",children:(0,t.jsx)("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.172 7.707 8.879a1 1 0 10-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"text-sm text-[#2a2a2a]",children:v}),(0,t.jsx)("button",{onClick:()=>y(null),className:"ml-auto text-gray-400 hover:text-gray-600","aria-label":"Dismiss",children:(0,t.jsx)("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}),i?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Create New Waitlist"}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{id:"name",type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"My Awesome Product",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-[#2a2a2a]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (optional)"}),(0,t.jsx)("textarea",{id:"description",value:x,onChange:e=>h(e.target.value),placeholder:"Tell people what they're signing up for...",rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-[#2a2a2a]"})]}),b&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-red-600",children:b})}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{o(!1),m(""),h(""),f("")},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:g,className:"flex-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Creating...":"Create Waitlist"})]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:N,className:"mb-6 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98]",children:"+ Create Waitlist"}),d&&j&&(0,t.jsx)(n,{isOpen:d,onClose:()=>c(!1),currentSignups:j.currentUsage,signupLimit:j.limit,onFeedbackSent:()=>{y("Feedback sent (we keep you updated?)")}})]})]})}var d=e.i(18566);function c({waitlist:e,signupCount:r}){let s=(0,d.useRouter)();return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow cursor-pointer",onClick:()=>s.push(`/dashboard/waitlist/${e.id}`),children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-gray-500",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),r," signup",1!==r?"s":""]}),(0,t.jsx)("span",{className:"text-gray-400",children:"â€¢"}),(0,t.jsxs)("span",{className:"text-gray-500",children:["Created ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsx)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",onClick:t=>{t.stopPropagation(),s.push(`/dashboard/waitlist/${e.id}`)},children:"View â†’"})})]})})}function u({userId:e,initialWaitlists:a}){let[l,i]=(0,r.useState)(a),[n,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),h=(0,d.useRouter)(),g=(0,d.useSearchParams)(),p=(0,r.useMemo)(()=>g.get("success"),[g]);(0,r.useEffect)(()=>{if("true"===p){x("Payment received â€” your plan is now Pro.");let e=new URL(window.location.href);e.searchParams.delete("success"),h.replace(e.pathname+(e.search?e.search:""));let t=window.setTimeout(()=>{h.refresh()},1e3),r=window.setTimeout(()=>{x(null)},5e3);return()=>{window.clearTimeout(r),window.clearTimeout(t)}}},[h,p]);let b=async()=>{u(!0);try{let t=(0,s.createClientBrowser)(),{data:r,error:a}=await t.from("waitlists").select("*, signups(count)").eq("owner_id",e).order("created_at",{ascending:!1});if(a)return void console.error("Error fetching waitlists:",a);i(r||[])}catch(e){console.error("Error refreshing waitlists:",e)}finally{u(!1)}};return(0,t.jsxs)(t.Fragment,{children:[m&&(0,t.jsx)("div",{className:"fixed top-5 right-5 z-[9999]",children:(0,t.jsx)("div",{className:"max-w-sm rounded-lg border border-green-200 bg-green-50 px-4 py-3 shadow-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"mt-0.5 text-green-600",children:(0,t.jsx)("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.172 7.707 8.879a1 1 0 10-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"text-sm text-[#2a2a2a]",children:m}),(0,t.jsx)("button",{onClick:()=>x(null),className:"ml-auto text-gray-400 hover:text-gray-600","aria-label":"Dismiss",children:(0,t.jsx)("svg",{viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}),(0,t.jsx)(o,{userId:e,onWaitlistCreated:b}),0===l.length?(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:(0,t.jsx)("p",{className:"text-gray-600 text-center py-12",children:"No waitlists yet. Create your first one to get started."})}):(0,t.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,t.jsx)(c,{waitlist:e,signupCount:e.signups?.[0]?.count||0},e.id))})]})}e.s(["default",()=>u],54173)}]);