'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var max = require('./max.cjs');
var min = require('./min.cjs');
var quickselect = require('./quickselect.cjs');
var number = require('./number.cjs');

function quantile(values, p, valueof) {
  values = Float64Array.from(number.numbers(values, valueof));
  if (!(n = values.length) || isNaN(p = +p)) return;
  if (p <= 0 || n < 2) return min.default(values);
  if (p >= 1) return max.default(values);
  var n,
      i = (n - 1) * p,
      i0 = Math.floor(i),
      value0 = max.default(quickselect.default(values, i0).subarray(0, i0 + 1)),
      value1 = min.default(values.subarray(i0 + 1));
  return value0 + (value1 - value0) * (i - i0);
}

function quantileSorted(values, p, valueof = number.default) {
  if (!(n = values.length) || isNaN(p = +p)) return;
  if (p <= 0 || n < 2) return +valueof(values[0], 0, values);
  if (p >= 1) return +valueof(values[n - 1], n - 1, values);
  var n,
      i = (n - 1) * p,
      i0 = Math.floor(i),
      value0 = +valueof(values[i0], i0, values),
      value1 = +valueof(values[i0 + 1], i0 + 1, values);
  return value0 + (value1 - value0) * (i - i0);
}

exports.default = quantile;
exports.quantileSorted = quantileSorted;
