'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var array = require('./array.cjs');
var constant = require('./constant.cjs');
var linear = require('./curve/linear.cjs');
var path = require('./path.cjs');
var point = require('./point.cjs');

function shapeLine(x, y) {
  var defined = constant.default(true),
      context = null,
      curve = linear.default,
      output = null,
      path$1 = path.withPath(line);

  x = typeof x === "function" ? x : (x === undefined) ? point.x : constant.default(x);
  y = typeof y === "function" ? y : (y === undefined) ? point.y : constant.default(y);

  function line(data) {
    var i,
        n = (data = array.default(data)).length,
        d,
        defined0 = false,
        buffer;

    if (context == null) output = curve(buffer = path$1());

    for (i = 0; i <= n; ++i) {
      if (!(i < n && defined(d = data[i], i, data)) === defined0) {
        if (defined0 = !defined0) output.lineStart();
        else output.lineEnd();
      }
      if (defined0) output.point(+x(d, i, data), +y(d, i, data));
    }

    if (buffer) return output = null, buffer + "" || null;
  }

  line.x = function(_) {
    return arguments.length ? (x = typeof _ === "function" ? _ : constant.default(+_), line) : x;
  };

  line.y = function(_) {
    return arguments.length ? (y = typeof _ === "function" ? _ : constant.default(+_), line) : y;
  };

  line.defined = function(_) {
    return arguments.length ? (defined = typeof _ === "function" ? _ : constant.default(!!_), line) : defined;
  };

  line.curve = function(_) {
    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;
  };

  line.context = function(_) {
    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;
  };

  return line;
}

exports.default = shapeLine;
